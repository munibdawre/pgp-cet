<!DOCTYPE html>
<html>
<head>
  <title>Flashcards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header>Flashcards</header>

<div class="box">
  <select id="subject" onchange="loadCards()">
    <option value="">Select Subject</option>
    <option>Anatomy</option>
    <option>Physiology</option>
    <option>Biochemistry</option>
    <option>Fundamentals of Exercise Therapy</option>
    <option>Fundamentals of Electro Therapy</option>
    <option>Pharmacology</option>
    <option>Pathology & Microbiology</option>
    <option>Psychology</option>
    <option>Psychiatry</option>
    <option>Electrical Agents</option>
    <option>Kinesio Therapeutics</option>
    <option>General Surgery & Orthopedics</option>
    <option>Medicine</option>
    <option>OBGY</option>
    <option>Physical Diagnosis & Manipulative Skills</option>
    <option>Physiotherapy in Musculoskeletal Condition</option>
    <option>Physiotherapy in Neurosciences</option>
    <option>Physiotherapy in General Medical & Gen. Surgical Condition</option>
    <option>Physiotherapy in Community Health</option>
  </select>

  <div class="card" id="card" onclick="flip()">Select a subject</div>

  <button onclick="prev()">Previous</button>
  <button onclick="next()">Next</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, query, where } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);
const firebaseConfig = {
  apiKey: "AIzaSyCz1RpCPMesqwVwD5ki916ZsHm9Doi7JtU",
  authDomain: "pgp-cet-portal.firebaseapp.com",
  projectId: "pgp-cet-portal",
  storageBucket: "pgp-cet-portal.firebasestorage.app",
  messagingSenderId: "369834140308",
  appId: "1:369834140308:web:8d9cadb6e095f7575c8a81"
};
let cards=[],i=0,flipSide=false;

window.loadCards=async()=>{
  const s=subject.value;
  if(!s) return;
  const q=query(collection(db,"questions"),where("subject","==",s));
  const snap=await getDocs(q);
  cards=snap.docs.map(d=>d.data());
  i=0;flipSide=false;
  render();
};

function render(){
  if(!cards.length){
    card.innerText="No flashcards available";
    return;
  }
  const c=cards[i];
  card.innerHTML=flipSide?
    `${c.correct}. ${c.options[c.correct]}<br><small>${c.explanation||""}</small>`:
    c.question;
}

window.flip=()=>{flipSide=!flipSide;render();};
window.next=()=>{if(i<cards.length-1){i++;flipSide=false;render();}};
window.prev=()=>{if(i>0){i--;flipSide=false;render();}};
</script>

</body>
</html>
